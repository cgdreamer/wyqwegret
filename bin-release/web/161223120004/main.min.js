var AnimationManager=function(){function t(){}var e=(__define,t);e.prototype;return t.createAnimation=function(t,e){var i=new egret.MovieClipDataFactory(t,e),s=new egret.MovieClip(i.generateMovieClipData());return s},t}();egret.registerClass(AnimationManager,"AnimationManager");var AudioManager=function(){function t(){this.sounds=new Array,this.soundUrlPrefix="resource/",this.currentBgSound=null,this.isBgsound=!1,this.isPlayBgsound=!1}var e=(__define,t),i=e.prototype;return i.play=function(t,e,i,s,n){void 0===n&&(n=!1),this.isBgsound=e,this.thisObj=s;var o=new RegExp("http:\\/\\/[^/]+","g");if(t=t.replace(o,"http://"+GlobalModel.host),this.currentSoundName=t,this.sounds.hasOwnProperty(t))e?(this.currentBgSound=this.sounds[t],this.currentBgSoundC=this.currentBgSound.play(0,999)):(this.sound=this.sounds[t],this.sound.play(0,1)),i&&i.call(s);else{var h="";this.functionWhenSoundStartPlaying=i,GlobalModel.soundUrls.hasOwnProperty(t)?(h=GlobalModel.soundUrls[t]+"_mp3",e?(this.currentBgSound=RES.getRes(h),this.currentBgSoundC=this.currentBgSound.play(0,998)):(this.sound=RES.getRes(h),this.sound.play(0,1))):e?(this.currentBgSound=new egret.Sound,this.currentBgSound.addEventListener(egret.Event.COMPLETE,this.loadComplete,this),this.currentBgSound.load(t)):(this.sound=new egret.Sound,this.sound.addEventListener(egret.Event.COMPLETE,this.loadComplete,this),this.sound.load(t),console.log("语音路径:"+t)),e?this.sounds[t]=this.currentBgSound:this.sounds[t]=this.sound}},i.loadComplete=function(t){this.isBgsound?this.currentBgSoundC=this.currentBgSound.play(0,998):(this.sound=this.sounds[this.currentSoundName],this.sound.play(0,1),console.log("语音加载完成:"+this.currentSoundName)),this.functionWhenSoundStartPlaying&&this.functionWhenSoundStartPlaying.call(this.thisObj)},i.stopBgSound=function(){this.currentBgSoundC&&this.currentBgSoundC.stop()},t}();egret.registerClass(AudioManager,"AudioManager");var DetailItemSprite=function(t){function e(e,i,s,n){t.call(this),this.FONT_SIZE=14,this.GAP=3,this.CORRECT_COLOR=5550408,this.WRONG_COLOR_0=16737942,this.WRONG_COLOR_1=14737632,this.DEFAULT_COLOR=12303553,this.CELL_H=43,this.FIRST_CELL_X=0,this.FIRST_CELL_W=64,this.SECOND_CELL_W=317,this.THIRD_CELL_W=64,this.FORTH_CELL_W=65,this.touchEnabled=!0,this.theWordInfo=e,this.detail=n,this.bg=new egret.Shape,this.addChild(this.bg),this.rightWrongBtnBitmap=new egret.Bitmap;var o,h;null!=i?(i?(o=this.CORRECT_COLOR,h=this.DEFAULT_COLOR,this.rightWrongBtnBitmap=new egret.Bitmap(RES.getRes("images.rightbtnbg"))):(o=this.WRONG_COLOR_0,h=this.WRONG_COLOR_1,this.rightWrongBtnBitmap=new egret.Bitmap(RES.getRes("images.wrongbtnbg"))),this.rightWrongBtnBitmap.x=this.FIRST_CELL_X+this.FIRST_CELL_W+this.GAP+this.SECOND_CELL_W+this.GAP+this.THIRD_CELL_W+this.GAP,this.addChild(this.rightWrongBtnBitmap)):(o=this.DEFAULT_COLOR,h=this.DEFAULT_COLOR,this.bg.graphics.beginFill(this.DEFAULT_COLOR,1),this.bg.graphics.drawRect(this.FIRST_CELL_X+this.FIRST_CELL_W+this.GAP+this.SECOND_CELL_W+this.GAP+this.THIRD_CELL_W+this.GAP,0,this.FORTH_CELL_W,this.CELL_H),this.bg.graphics.endFill()),this.bg.graphics.beginFill(o,1),this.bg.graphics.drawRect(this.FIRST_CELL_X,0,this.FIRST_CELL_W,this.CELL_H),this.bg.graphics.endFill(),this.bg.graphics.beginFill(h,1),this.bg.graphics.drawRect(this.FIRST_CELL_X+this.FIRST_CELL_W+this.GAP,0,this.SECOND_CELL_W,this.CELL_H),this.bg.graphics.endFill(),this.bg.graphics.beginFill(this.DEFAULT_COLOR,1),this.bg.graphics.drawRect(this.FIRST_CELL_X+this.FIRST_CELL_W+this.GAP+this.SECOND_CELL_W+this.GAP,0,this.THIRD_CELL_W,this.CELL_H),this.bg.graphics.endFill();var r=new egret.TextField;r.multiline=!1,r.wordWrap=!1,r.fontFamily=GlobalModel.font,r.size=this.FONT_SIZE,r.textColor=16777215,r.text=s+"",r.x=this.FIRST_CELL_X+(this.FIRST_CELL_W-r.width)/2,r.y=(this.CELL_H-r.height)/2,this.addChild(r);var a=new egret.TextField;a.multiline=!1,a.wordWrap=!1,a.fontFamily=GlobalModel.font,a.size=this.FONT_SIZE,a.textColor=0,a.text=e.pronounce,a.x=this.FIRST_CELL_X+this.FIRST_CELL_W+this.GAP+5,a.y=(this.CELL_H-a.height)/2,this.addChild(a);var l=RES.getRes("soundanimation_json"),d=RES.getRes("soundanimation_png");this.soundAnimation=AnimationManager.createAnimation(l,d),this.soundAnimation.addEventListener(egret.Event.COMPLETE,this.soundAnimCompleted,this),this.soundAnimation.gotoAndStop(1),this.soundAnimation.x=this.FIRST_CELL_X+this.FIRST_CELL_W+this.GAP+this.SECOND_CELL_W+this.GAP+10,this.soundAnimation.y=(this.CELL_H-this.soundAnimation.height)/2,this.addChild(this.soundAnimation),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.playSound,this)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.soundAnimCompleted=function(t){this.soundAnimation.stop(),this.detail.touchEnabled=!0,this.detail.touchChildren=!0},s.playSound=function(){this.detail.touchEnabled=!1,this.detail.touchChildren=!1,GlobalModel.audioManager.play(this.theWordInfo.sound,!1,this.startPlayAudio,this)},s.startPlayAudio=function(){this.soundAnimation.gotoAndPlay(1,1)},e}(egret.DisplayObjectContainer);egret.registerClass(DetailItemSprite,"DetailItemSprite");var DetailSprite=function(t){function e(){t.call(this),this.NUM_IN_PAGE=5,this.ITEM_X=38,this.ITEM_START_Y=136,this.ITEM_GAP=3,this.totalPage=0,this.pageIndex=0,this.itemSprite=new egret.DisplayObjectContainer,this.bg=new egret.Bitmap(RES.getRes("images.detailtablebg")),this.addChild(this.bg),this.itemSprite.x=this.ITEM_X,this.itemSprite.y=this.ITEM_START_Y,this.addChild(this.itemSprite),this.pageSprite=new egret.DisplayObjectContainer,this.leftPageBtn=new SimpleButton("images.lefttbtnup","images.lefttbtnover","images.lefttbtndisabled"),this.leftPageBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.pageBtnMouseDownHandler,this),this.leftPageBtn.enable=!1,this.pageSprite.addChild(this.leftPageBtn),this.pageIndexText=new egret.TextField,this.pageIndexText.multiline=!1,this.pageIndexText.wordWrap=!1,this.pageIndexText.fontFamily=GlobalModel.font,this.pageIndexText.size=15,this.pageIndexText.textColor=0,this.pageIndexText.x=this.leftPageBtn.x+this.leftPageBtn.width+19,this.pageSprite.addChild(this.pageIndexText),this.rightPageBtn=new SimpleButton("images.rightbtnup","images.rightbtnover","images.rightbtndisabled"),this.rightPageBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.pageBtnMouseDownHandler,this),this.pageSprite.addChild(this.rightPageBtn),this.pageSprite.y=381,this.addChild(this.pageSprite),this.perfectBitmap=new egret.Bitmap(RES.getRes("images.perfect")),this.veryGoodBitmap=new egret.Bitmap(RES.getRes("images.very good")),this.goodBitmap=new egret.Bitmap(RES.getRes("images.good")),this.lostBitmap=new egret.Bitmap(RES.getRes("images.you lost")),this.returnBtn=new SimpleButton("images.detailreturnbtnup","images.detailreturnbtnover"),this.returnBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.returnBtnMouseDown,this),this.returnBtn.x=238,this.returnBtn.y=458,this.addChild(this.returnBtn)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.returnBtnMouseDown=function(t){this.rankBitmap&&(this.rankBitmap.parent&&this.rankBitmap.parent.removeChild(this.rankBitmap),this.rankBitmap=null),GlobalModel.main.getSceneByName("PlayScene").showDetailSprite(!1)},s.pageBtnMouseDownHandler=function(t){t.currentTarget.enable=!1,t.currentTarget==this.leftPageBtn?this.pageIndex=this.pageIndex-1:this.pageIndex=this.pageIndex+1,this.gotoPageByIndex(this.pageIndex)},s.gotoPageByIndex=function(t){this.pageIndexText.text=t+1+"/"+this.totalPage,this.rightPageBtn.x=this.pageIndexText.x+this.pageIndexText.width+19,this.pageSprite.x=(this.bg.width-this.pageSprite.width)/2;var e,i,s,n=GlobalModel.wordsInfo.concat().splice(t*this.NUM_IN_PAGE,5),o=null;for(this.itemSprite.removeChildren(),s=0;s<n.length;s++)i=t*this.NUM_IN_PAGE+s,o=i<=GlobalModel.doneNumber-1?-1!=GlobalModel.rightWords.indexOf(i)?!0:!1:null,e=new DetailItemSprite(n[s],o,i+1,this),e.y=s*(e.height+this.ITEM_GAP),this.itemSprite.addChild(e);this.pageIndex>0?this.leftPageBtn.enable=!0:this.leftPageBtn.enable=!1,this.pageIndex<this.totalPage-1?this.rightPageBtn.enable=!0:this.rightPageBtn.enable=!1},s.refresh=function(){if(this.totalPage=Math.ceil(GlobalModel.wordsInfo.length/this.NUM_IN_PAGE),this.pageIndex=0,this.totalPage>1?this.rightPageBtn.enable=!0:this.rightPageBtn.enable=!1,GlobalModel.isPlayEnd){GlobalModel.rightPercent>=90?this.rankBitmap=this.perfectBitmap:GlobalModel.rightPercent>=75?this.rankBitmap=this.veryGoodBitmap:GlobalModel.rightPercent>=60?this.rankBitmap=this.goodBitmap:this.rankBitmap=this.lostBitmap;var t=this.width-56-this.rankBitmap.width,e=380;this.rankBitmap.scaleX=3,this.rankBitmap.scaleY=3,this.rankBitmap.alpha=.1,this.rankBitmap.x=t-138,this.rankBitmap.y=328,this.addChild(this.rankBitmap),egret.Tween.get(this.rankBitmap).to({x:t,y:e,scaleX:1,scaleY:1,alpha:1},600)}this.gotoPageByIndex(this.pageIndex)},e}(egret.DisplayObjectContainer);egret.registerClass(DetailSprite,"DetailSprite");var GameIntroSprite=function(t){function e(){t.call(this),this.FONT_SHADOW_SIZE=21,this.FONT_SIZE=16,this.LINE_GAP=19;var e=new egret.Shape;e.graphics.beginFill(0,0),e.graphics.drawRect(0,0,GlobalModel.contentWidth,GlobalModel.contentHeight),e.graphics.endFill(),this.addChild(e);var i=new egret.Bitmap(RES.getRes("images.gameintropanelbg"));this.bgWidth=i.width,this.bgHeight=i.height,i.x=(this.width-this.bgWidth)/2,i.y=(this.height-this.bgHeight)/2,this.addChild(i);var s=new egret.TextField;s.multiline=!1,s.wordWrap=!1,s.type=egret.TextFieldType.DYNAMIC,s.fontFamily=GlobalModel.font,s.bold=!0,s.size=this.FONT_SHADOW_SIZE,s.textColor=0,s.stroke=3,s.strokeColor=0,s.text="游戏说明",s.x=(this.width-s.width)/2+3,s.y=i.y+50,s.alpha=.3,this.addChild(s);var n=new egret.TextField;n.multiline=!1,n.wordWrap=!1,n.type=egret.TextFieldType.DYNAMIC,n.fontFamily=GlobalModel.font,n.bold=!0,n.size=this.FONT_SHADOW_SIZE,n.textColor=4928530,n.stroke=3,n.strokeColor=16777215,n.text="游戏说明",n.x=s.x-3,n.y=s.y-3,this.addChild(n);var o=new egret.TextField;o.multiline=!1,o.wordWrap=!0,o.lineSpacing=this.LINE_GAP,o.width=this.bgWidth-150,o.fontFamily=GlobalModel.font,o.bold=!0,o.size=this.FONT_SIZE,o.textColor=3355443,o.text="      森林里住着一只嘟嘟鸟，据说她能听懂英文单词，同学们快来验证一下吧！！\n       操作说明：先观察所给的单词，然后大喇叭会发出一个单词的读音，如果没有听清楚，可以点击叭再听一次。听听它读的是哪个单词呢？请在6秒内做出选择，如果你选中了正确单词，嘟嘟鸟便会高兴的舞蹈哦！",o.x=(this.width-o.width)/2-16,o.y=i.y+108,this.addChild(o);var h=new SimpleButton("images.startscenereturnup","images.startscenereturnover");h.x=(this.width-h.width)/2,h.y=i.y+i.height-21,this.addChild(h),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.removeFromStage,this),this.touchEnabled=!0}__extends(e,t);var i=(__define,e),s=i.prototype;return s.removeFromStage=function(t){this.parent.removeChild(this)},e}(egret.Sprite);egret.registerClass(GameIntroSprite,"GameIntroSprite");var GlobalModel=function(){function t(){}var e=(__define,t);e.prototype;return t.isDebug=!0,t.version="1.1.0",t.contentWidth=800,t.contentHeight=600,t.font="微软雅黑",t.host="www.anoah.com",t.scenes=new Array,t.startTime=6,t.playTime=0,t.recordCommitted=!1,t.soundUrls={right:"right",wrong:"wrong",bg:"bgm"},t.rightPercent=0,t.isPlayEnd=!1,t.isTimeEnd=!1,t.isWin=null,t.doneNumber=0,t.rightNumber=0,t.wrongWords=new Array,t.rightWords=new Array,t}();egret.registerClass(GlobalModel,"GlobalModel");var LabaSprite=function(t){function e(){t.call(this),this.wordBarPos=[[80,0],[88,108],[80,158]],this.wordBars=[],this.wordBtnMaskInfos=[[28,15,226,54],[14,13,261,57],[28,66,232,61]],this.wordTextPos=[[10,-25],[21,-5],[10,21]],this.wordBarTexts=[],this.wordBarMoved=0,this.wordPlayOnce=!1;for(var e,i,s=0;s<this.wordBarPos.length;s++)e=new SimpleButton("images.wBtnUp"+(s+1),"images.wBtnOver"+(s+1),"",!1,new egret.Rectangle(this.wordBtnMaskInfos[s][0],this.wordBtnMaskInfos[s][1],this.wordBtnMaskInfos[s][2],this.wordBtnMaskInfos[s][3])),e.y=this.wordBarPos[s][1],this.wordBars.push(e),i=new egret.TextField,i.multiline=!1,i.wordWrap=!1,i.fontFamily=GlobalModel.font,i.bold=!0,i.size=19,i.textColor=0,i.selfParent=e,e.wordText=i,this.wordBarTexts.push(i),e.addChild(i),e.addEventListener(egret.TouchEvent.TOUCH_TAP,this.check,this),this.addChild(e);var n=RES.getRes("laba_json"),o=RES.getRes("laba_png");this.labaAnimation=AnimationManager.createAnimation(n,o),this.labaAnimation.addEventListener(egret.Event.COMPLETE,this.labaPlayComplete,this),this.labaAnimation.addEventListener(egret.TouchEvent.TOUCH_TAP,this.pronounce,this),this.labaAnimation.stop(),this.labaAnimation.y=(this.height-this.labaAnimation.height)/2,this.addChild(this.labaAnimation)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.labaPlayComplete=function(){this.labaAnimation.stop(),this.wordPlayOnce||(this.wordPlayOnce=!0,GlobalModel.main.getSceneByName("PlayScene").startTime())},s.resetBtns=function(){for(var t,e=0;e<this.wordBars.length;e++)t=this.wordBars[e],t.x=-t.width-5,this.wordBarTexts[e].visible=!1},s.check=function(t){GlobalModel.main.getSceneByName("PlayScene").answerCorrect(t.currentTarget.isCorrect,this.correctAnswer,t.currentTarget.wordText.text)},s.pronounce=function(){GlobalModel.audioManager.play(this.soundUrl,!1,this.labaAnimationPlay,this)},s.labaAnimationPlay=function(){this.labaAnimation.gotoAndPlay(1,1)},s.wordBarMoveComplete=function(t){this.wordBarMoved++;var t=t;t.wordText.visible=!0,this.wordBarMoved>=this.wordBars.length&&GlobalModel.audioManager.play(this.soundUrl,!1,this.labaAnimationPlay,this)},s.start=function(t,e){this.wordPlayOnce=!1,this.resetBtns();var i=this.wordBarTexts.length;t.length=i,this.soundUrl=e,this.wordBarMoved=0;var s,n;this.correctAnswer=t[0];for(var o,h,r,a=0;i>a;a++){s=this.wordBarTexts[a],h=t.length,o=Math.floor(Math.random()*h),r=t.splice(o,1)[0],s.text=r,n=s.selfParent,n.isCorrect=r==this.correctAnswer;var l=0;s.x=(n.width-s.width)/2+this.wordTextPos[a][0],s.y=(n.height-s.height)/2+this.wordTextPos[a][1]+l,egret.setTimeout(this.delayWordBarMoveFunction,this,190*a,[n,this.wordBarPos[a][0]])}},s.delayWordBarMoveFunction=function(t){egret.Tween.get(t[0]).to({x:t[1]},380,egret.Ease.backInOut).call(this.wordBarMoveComplete,this,[t[0]])},e}(egret.DisplayObjectContainer);egret.registerClass(LabaSprite,"LabaSprite");var LoaderClass=function(){function t(){}var e=(__define,t),i=e.prototype;return i.sendPostRequest=function(t,e,i,s,n,o){void 0===e&&(e=null),void 0===i&&(i=null),void 0===s&&(s=null),void 0===n&&(n=egret.URLRequestMethod.GET),void 0===o&&(o=egret.URLLoaderDataFormat.TEXT),this.theResultHandler=i,this.theFaultHandler=null==s?this.ioErrorHandler:s;var h;h=new egret.URLRequest(t);var r=new egret.URLRequestHeader("Access-Control-Allow-Origin","*");h.requestHeaders.push(r),r=new egret.URLRequestHeader("Access-Control-Allow-Origin","http://127.0.0.1"),h.requestHeaders.push(r);var a=new egret.URLVariables(e);h.method=n,h.data=a;var l=new egret.URLLoader;l.dataFormat=o,l.addEventListener(egret.Event.COMPLETE,this.completeHandler,this),l.addEventListener(egret.IOErrorEvent.IO_ERROR,this.ioErrorHandler,this),l.load(h)},i.completeHandler=function(t){void 0===t&&(t=null);var e=JSON.parse(t.target.data);null!=this.theResultHandler&&this.theResultHandler(e)},i.ioErrorHandler=function(t){void 0===t&&(t=null),console.warn("网络问题,出现网络问题,请稍后再试")},t}();egret.registerClass(LoaderClass,"LoaderClass");var LoadingUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e),s=i.prototype;return s.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},s.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.call(this),this.params=null,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),GlobalModel.main=this}__extends(e,t);var i=(__define,e),s=i.prototype;return s.onAddToStage=function(t){this.onResize(),this.stage.addEventListener(egret.Event.RESIZE,this.onResize,this),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},s.onResize=function(t){this.scaleX=this.stage.stageWidth/GlobalModel.contentWidth,this.scaleY=this.stage.stageHeight/GlobalModel.contentHeight},s.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onLoaded,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},s.onLoaded=function(t){"preload"==t.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onLoaded,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},s.onItemLoadError=function(t){},s.onResourceLoadError=function(t){this.onLoaded(t)},s.onResourceProgress=function(t){"resource"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},s.createGameScene=function(){this.addChild(this.createBitmapByName("gamescenebg")),this.loadingView=new LoadingUI,this.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoaded,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("resource")},s.onResourceLoaded=function(t){this.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onLoaded,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.loadFromServer()},s.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},s.changeToSceneByName=function(t){if(GlobalModel.scenes[t])this.showSceneWhenSceneIsReady(GlobalModel.scenes[t],t);else{var e=egret.getDefinitionByName(t);GlobalModel.scenes[t]=new e,this.showSceneWhenSceneIsReady(GlobalModel.scenes[t],t)}},s.getSceneByName=function(t){return GlobalModel.scenes[t]?GlobalModel.scenes[t]:void 0},s.commitRecord=function(){},s.generateRecord=function(t,e,i,s,n,o,h){},s.showSceneWhenSceneIsReady=function(t,e){GlobalModel.currentScene&&this.removeChild(GlobalModel.currentScene),GlobalModel.currentScene=t,GlobalModel.currentSceneName=e,this.addChild(t),"PlayScene"==e&&t.start()},s.loadFromServer=function(){var t;GlobalModel.isDebug&&(t="<data><psIds>1,2,3,4,5,6,7,8</psIds></data>");var e=new DOMParser;this.params=e.parseFromString(t,"text/xml");var i=this.params.getElementsByTagName("psIds")[0].childNodes[0].nodeValue,s={},n={ids:i};s.info=n,s.app_key="wyqw",s.token="";var o="info="+JSON.stringify(s);(new LoaderClass).sendPostRequest("http://"+GlobalModel.host+"/api_cache/","q=json/oauth/apps/phonetic/lists&"+o,this.getUnitWorldResultHander)},s.getUnitWorldResultHander=function(t){GlobalModel.audioManager=new AudioManager;var e=t.recordset,i=e.length;GlobalModel.wordsInfo=new Array;for(var s,n=0;i>n;n++){s={},s.pronounce=e[n].content,s.sound=e[n].audio;var o=e[n].confusingwords;s.confusingwords=[];for(var h in o)s.confusingwords.push(o[h].content);GlobalModel.wordsInfo.push(s)}GlobalModel.main.changeToSceneByName("StartScene")},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var PlayScene=function(t){function e(){t.call(this),this.birdAnimations={};var e=RES.getRes("right0_json"),i=RES.getRes("right0_png"),s=AnimationManager.createAnimation(e,i);s.scaleX=GlobalModel.contentWidth/s.width,s.scaleY=s.scaleX,s.animType="right",s.addEventListener(egret.Event.COMPLETE,this.animComplete,this),s.y=-238,this.birdAnimations.right=[s],this.birdAnimations.wrong=[],e=RES.getRes("wrong0_json"),i=RES.getRes("wrong0_png"),s=AnimationManager.createAnimation(e,i),s.scaleX=GlobalModel.contentWidth/s.width,s.scaleY=s.scaleX,s.animType="wrong",s.addEventListener(egret.Event.COMPLETE,this.animComplete,this),this.birdAnimations.wrong.push(s),e=RES.getRes("wrong1_json"),i=RES.getRes("wrong1_png"),s=AnimationManager.createAnimation(e,i),s.scaleX=GlobalModel.contentWidth/s.width,s.scaleY=s.scaleX,s.animType="wrong",s.addEventListener(egret.Event.COMPLETE,this.animComplete,this),this.birdAnimations.wrong.push(s),this.birdAnimations.normal=[],e=RES.getRes("normal0_json"),i=RES.getRes("normal0_png"),s=AnimationManager.createAnimation(e,i),s.scaleX=GlobalModel.contentWidth/s.width,s.scaleY=s.scaleX,s.animType="normal",s.addEventListener(egret.Event.COMPLETE,this.animComplete,this),this.birdAnimations.normal.push(s),e=RES.getRes("normal1_json"),i=RES.getRes("normal1_png"),s=AnimationManager.createAnimation(e,i),s.scaleX=GlobalModel.contentWidth/s.width,s.scaleY=s.scaleX,s.animType="normal",s.addEventListener(egret.Event.COMPLETE,this.animComplete,this),this.birdAnimations.normal.push(s),e=RES.getRes("normal2_json"),i=RES.getRes("normal2_png"),s=AnimationManager.createAnimation(e,i),s.scaleX=GlobalModel.contentWidth/s.width,s.scaleY=s.scaleX,s.animType="normal",s.addEventListener(egret.Event.COMPLETE,this.animComplete,this),this.birdAnimations.normal.push(s),this.labaSprite=new LabaSprite,this.labaSprite.x=-9,this.labaSprite.y=10,this.addChild(this.labaSprite),this.wordNumberTextShadow=new egret.TextField,this.wordNumberTextShadow.multiline=!1,this.wordNumberTextShadow.wordWrap=!1,this.wordNumberTextShadow.fontFamily=GlobalModel.font,this.wordNumberTextShadow.bold=!0,this.wordNumberTextShadow.size=28,this.wordNumberTextShadow.textColor=11023375,this.wordNumberTextShadow.x=GlobalModel.contentWidth-180,this.wordNumberTextShadow.y=28,this.wordNumberTextShadow.alpha=.8,this.addChild(this.wordNumberTextShadow),this.wordNumberText=new egret.TextField,this.wordNumberText.multiline=!1,this.wordNumberText.wordWrap=!1,this.wordNumberText.fontFamily=GlobalModel.font,this.wordNumberText.bold=!0,this.wordNumberText.size=28,this.wordNumberText.textColor=16446077,this.wordNumberText.stroke=3,this.wordNumberText.strokeColor=11023375,this.wordNumberText.x=this.wordNumberTextShadow.x+3,this.wordNumberText.y=this.wordNumberTextShadow.y-3,this.addChild(this.wordNumberText),this.timeSprite=new TimeSprite,this.timeSprite.x=(GlobalModel.contentWidth-this.timeSprite.width)/2,this.timeSprite.visible=!1,this.addChild(this.timeSprite),this.birdAnimationSprite=new egret.DisplayObjectContainer,this.birdAnimationSprite.y=GlobalModel.contentHeight/2-118,this.birdAnimationSprite.touchEnabled=!1,this.birdAnimationSprite.touchChildren=!1,this.addChild(this.birdAnimationSprite),this.backButton=new SimpleButton("images.backbtnup","images.backbtnover"),this.backButton.x=19,this.backButton.y=GlobalModel.contentHeight-this.backButton.height-19,this.backButton.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.pause,this),this.addChild(this.backButton),this.maskBg=new egret.Shape,this.maskBg.graphics.beginFill(16777215,.3),this.maskBg.graphics.drawRect(0,0,GlobalModel.contentWidth,GlobalModel.contentHeight),this.maskBg.graphics.endFill(),this.maskBg.touchEnabled=!1,this.maskBg.visible=!1,this.addChild(this.maskBg),this.wordsPanel=new egret.DisplayObjectContainer,this.wordsPanel.addChild(new egret.Bitmap(RES.getRes("images.wordspanel"))),this.englishText=new egret.TextField,this.englishText.multiline=!1,this.englishText.wordWrap=!1,this.englishText.fontFamily=GlobalModel.font,this.englishText.bold=!0,this.englishText.size=39,this.englishText.textColor=2856976,this.wordsPanel.addChild(this.englishText),this.wordsPanel.x=(GlobalModel.contentWidth-this.wordsPanel.width)/2,this.wordsPanelY=-this.wordsPanel.height-5,this.wordsPanelToY=this.wordsPanelY+580,this.wordsPanel.y=this.wordsPanelY,this.addChild(this.wordsPanel),this.reportPanel=new ReportSprite,this.reportPanel.x=(GlobalModel.contentWidth-this.reportPanel.width)/2,this.reportPanel.y=(GlobalModel.contentHeight-this.reportPanel.height)/2,this.reportPanel.visible=!1,this.addChild(this.reportPanel),this.detailSprite=new DetailSprite,this.detailSprite.x=(GlobalModel.contentWidth-this.detailSprite.width)/2,this.detailSprite.y=(GlobalModel.contentHeight-this.detailSprite.height)/2,this.detailSprite.visible=!1,this.addChild(this.detailSprite)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.animComplete=function(t){var e=t.currentTarget;switch(e.stop(),e.animType){case"right":this.checkCorrect(!0);break;case"wrong":this.checkCorrect(!1);break;case"normal":this.showAnimationType("normal")}},s.pause=function(){null!=GlobalModel.isWin||GlobalModel.isTimeEnd||(this.reportPanel.visible=!0,this.timeSprite.stopTime(),this.reportPanel.refresh(),this.timeSprite.visible=!1,this.labaSprite.visible=!1,this.wordNumberTextShadow.visible=!1,this.wordNumberText.visible=!1,this.birdAnimationSprite.visible=!1,this.backButton.visible=!1)},s.resumePlay=function(){null!=GlobalModel.isWin||GlobalModel.isTimeEnd||(this.reportPanel.visible=!1,this.timeSprite.visible=!0,this.labaSprite.visible=!0,this.wordNumberTextShadow.visible=!0,this.wordNumberText.visible=!0,this.birdAnimationSprite.visible=!0,this.backButton.visible=!0,this.timeSprite.resume())},s.showDetailSprite=function(t){this.reportPanel.visible=!t,this.detailSprite.visible=t,t&&this.detailSprite.refresh()},s.showAnimationType=function(t){var e=this.birdAnimations[t],i=e.length,s=Math.floor(Math.random()*i),n=e[s];this.birdAnimationSprite.removeChildren(),this.birdAnimationSprite.addChild(n),n.gotoAndPlay(1,1)},s.timeEnd=function(){null!=GlobalModel.isWin||this.reportPanel.visible||(this.touchEnabled=!1,this.touchChildren=!1,GlobalModel.isTimeEnd=!0,GlobalModel.isWin=!1,this.timeSprite.visible=!1,GlobalModel.doneNumber+=1,GlobalModel.wrongWords.push(this.playingWordIndex),this.showAnimationType("wrong"))},s.wordsPanelStartMoving=function(t){egret.Tween.get(t.wordsPanel).to({y:t.wordsPanelY},300).call(t.wordsPanelMoveUpComplete,t)},s.wordsPanelMoveDownComplete=function(){GlobalModel.audioManager.play(this.currentWordInfo.sound,!1,this.currentSoundPlayFunc,this)},s.currentSoundPlayFunc=function(){setTimeout(this.wordsPanelStartMoving,3e3,this)},s.wordsPanelMoveUpComplete=function(){this.maskBg.visible=!1,this.playNextWord()},s.checkCorrect=function(t){this.maskBg.visible=!0,this.englishText.text=this.currentWordInfo.pronounce,this.englishText.x=(this.wordsPanel.width-this.englishText.width)/2,this.englishText.y=(this.wordsPanel.height-this.englishText.height)/2+180,egret.Tween.get(this.wordsPanel).to({y:this.wordsPanelToY},800,egret.Ease.backInOut).call(this.wordsPanelMoveDownComplete,this)},s.answerCorrect=function(t,e,i){if(!GlobalModel.isTimeEnd){GlobalModel.isWin=t,this.touchEnabled=!1,this.touchChildren=!1,this.backButton.visible=!1,this.timeSprite.stopTime(),this.timeSprite.visible=!1,GlobalModel.doneNumber+=1;var s,n,o=[e],h=[i];t?(s="right",GlobalModel.rightWords.push(this.playingWordIndex),GlobalModel.rightNumber++,n=100):(s="wrong",GlobalModel.wrongWords.push(this.playingWordIndex),n=0),GlobalModel.main.generateRecord(this.playingWordIndex,n,"VLearning_WordSpell_LetterSpellScore",100,o,h,1),this.showAnimationType(s),GlobalModel.audioManager.play(s,!1,null,this,!0)}},s.playNextWord=function(){if(GlobalModel.isTimeEnd=!1,GlobalModel.isWin=null,this.touchEnabled=!1,this.touchChildren=!1,this.showAnimationType("normal"),this.currentWordInfo=this.wordInfos.shift(),this.currentWordInfo){var t=[this.currentWordInfo.pronounce];t=t.concat(this.currentWordInfo.confusingwords),this.labaSprite.start(t,this.currentWordInfo.sound);var e=GlobalModel.wordsInfo.length-this.wordInfos.length;this.playingWordIndex=e-1;var i=e+" / "+GlobalModel.wordsInfo.length;this.wordNumberTextShadow.text=i,this.wordNumberText.text=i}else GlobalModel.main.commitRecord(),GlobalModel.isPlayEnd=!0,this.reportPanel.visible=!0,this.timeSprite.stopTime(),this.reportPanel.refresh(!0),this.timeSprite.visible=!1,this.labaSprite.visible=!1,this.wordNumberTextShadow.visible=!1,this.wordNumberText.visible=!1,this.birdAnimationSprite.visible=!1,this.backButton.visible=!1,this.touchEnabled=!0,this.touchChildren=!0},s.startTime=function(){this.timeSprite.start(this.timeEnd,this),this.timeSprite.visible=!0,this.touchEnabled=!0,this.touchChildren=!0,this.backButton.visible=!0},s.start=function(){GlobalModel.isPlayEnd=!1,GlobalModel.playTime=0,GlobalModel.rightNumber=0,GlobalModel.doneNumber=0,GlobalModel.rightWords.length=0,GlobalModel.wrongWords.length=0,this.wordInfos=GlobalModel.wordsInfo.concat(),this.reportPanel.visible=!1,this.timeSprite.visible=!1,this.labaSprite.visible=!0,this.wordNumberTextShadow.visible=!0,this.wordNumberText.visible=!0,this.birdAnimationSprite.visible=!0,this.backButton.visible=!0;for(var t,e=0;e<this.wordInfos.length;e++)t=this.wordInfos[e],GlobalModel.main.generateRecord(e,0,"VLearning_WordSpell_LetterSpellScore",100,[t.pronounce],[],1);this.playNextWord()},e}(egret.DisplayObjectContainer);egret.registerClass(PlayScene,"PlayScene");var ReportSprite=function(t){function e(){t.call(this),this.fontSz=19,this.positions=[[{x:190,y:87,w:123,h:51},{x:490,y:87,w:118,h:51}],[{x:190,y:140,w:123,h:51},{x:490,y:140,w:118,h:51}],[{x:190,y:194,w:123,h:51},{x:490,y:194,w:118,h:51}]],this.bg=new egret.Bitmap(RES.getRes("images.reporttablebg")),this.addChild(this.bg),this.totalQT=new egret.TextField,this.totalQT.multiline=!1,this.totalQT.wordWrap=!1,this.totalQT.fontFamily=GlobalModel.font,this.totalQT.bold=!0,this.totalQT.size=this.fontSz,this.totalQT.textColor=0,this.addChild(this.totalQT),this.doneQT=new egret.TextField,this.doneQT.multiline=!1,this.doneQT.wordWrap=!1,this.doneQT.fontFamily=GlobalModel.font,this.doneQT.bold=!0,this.doneQT.size=this.fontSz,this.doneQT.textColor=0,this.addChild(this.doneQT),this.rightQT=new egret.TextField,this.rightQT.multiline=!1,this.rightQT.wordWrap=!1,this.rightQT.fontFamily=GlobalModel.font,this.rightQT.bold=!0,this.rightQT.size=this.fontSz,this.rightQT.textColor=0,this.addChild(this.rightQT),this.timeQT=new egret.TextField,this.timeQT.multiline=!1,this.timeQT.wordWrap=!1,this.timeQT.fontFamily=GlobalModel.font,this.timeQT.bold=!0,this.timeQT.size=this.fontSz,this.timeQT.textColor=0,this.addChild(this.timeQT),this.donePT=new egret.TextField,this.donePT.multiline=!1,this.donePT.wordWrap=!1,this.donePT.fontFamily=GlobalModel.font,this.donePT.bold=!0,this.donePT.size=this.fontSz,this.donePT.textColor=6816004,this.addChild(this.donePT),this.rightPT=new egret.TextField,this.rightPT.multiline=!1,this.rightPT.wordWrap=!1,this.rightPT.fontFamily=GlobalModel.font,this.rightPT.bold=!0,this.rightPT.size=this.fontSz,this.rightPT.textColor=6816004,this.addChild(this.rightPT);var e=new SimpleButton("images.returnstartbtnup","images.returnstartbtnover");e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){GlobalModel.main.commitRecord(),GlobalModel.main.changeToSceneByName("StartScene")},this),e.x=113,e.y=283,this.addChild(e);var i=new SimpleButton("images.showdetailbtnup","images.showdetailbtnover");i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){GlobalModel.main.getSceneByName("PlayScene").showDetailSprite(!0)},this),i.x=277,i.y=283,this.addChild(i),this.continueBtn=new SimpleButton("images.continuebtnup","images.continuebtnover","images.continuebtndisabled"),this.continueBtn.x=437,this.continueBtn.y=283,this.continueBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){GlobalModel.main.getSceneByName("PlayScene").resumePlay()},this),this.addChild(this.continueBtn)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.getTimeString=function(t){var e=Math.round(t/1e3),i=Math.floor(e/60),s=Math.ceil(e%60)+"",n="";return i>0&&(n=i+"分"),n=n+s+"秒"
},s.refresh=function(t){void 0===t&&(t=!1),this.totalQT.text=GlobalModel.wordsInfo.length+"",this.totalQT.x=this.positions[0][0].x+(this.positions[0][0].w-this.totalQT.width)/2,this.totalQT.y=this.positions[0][0].y+(this.positions[0][0].h-this.totalQT.height)/2,this.doneQT.text=GlobalModel.doneNumber+"",this.doneQT.x=this.positions[1][0].x+(this.positions[1][0].w-this.doneQT.width)/2,this.doneQT.y=this.positions[1][0].y+(this.positions[1][0].h-this.doneQT.height)/2,this.rightQT.text=GlobalModel.rightNumber+"",this.rightQT.x=this.positions[2][0].x+(this.positions[2][0].w-this.rightQT.width)/2,this.rightQT.y=this.positions[2][0].y+(this.positions[2][0].h-this.rightQT.height)/2,this.timeQT.text=this.getTimeString(GlobalModel.playTime),this.timeQT.x=this.positions[0][1].x+(this.positions[0][1].w-this.timeQT.width)/2,this.timeQT.y=this.positions[0][1].y+(this.positions[0][1].h-this.timeQT.height)/2,this.donePT.text=Math.round(GlobalModel.doneNumber/GlobalModel.wordsInfo.length*100)+"%",this.donePT.x=this.positions[1][1].x+(this.positions[1][1].w-this.donePT.width)/2,this.donePT.y=this.positions[1][1].y+(this.positions[1][1].h-this.donePT.height)/2;var e;GlobalModel.doneNumber>0?(e=Math.round(GlobalModel.rightNumber/GlobalModel.doneNumber*100),GlobalModel.rightPercent=e,this.rightPT.text=e+"%"):this.rightPT.text="0%",this.rightPT.x=this.positions[2][1].x+(this.positions[2][1].w-this.rightPT.width)/2,this.rightPT.y=this.positions[2][1].y+(this.positions[2][1].h-this.rightPT.height)/2,t?this.continueBtn.enable=!1:this.continueBtn.enable=!0},e}(egret.DisplayObjectContainer);egret.registerClass(ReportSprite,"ReportSprite");var SimpleButton=function(t){function e(e,i,s,n,o){void 0===i&&(i=""),void 0===s&&(s=""),void 0===n&&(n=!1),void 0===o&&(o=null),t.call(this),this.upbit=null,this.downbit=null,this.disenablebit=null,this.currentState=1,this._enable=!0,this.touchEnabled=!0,this.isClip=n,this.init(e,i,s,o)}__extends(e,t);var i=__define,s=e,n=s.prototype;return i(n,"enable",function(){return this._enable},function(t){this._enable=t,this.hitAreaObj?this.hitAreaObj.touchEnabled=t:this.touchEnabled=t,null!=this.disenablebit&&(this.disenablebit.visible=!t,this.upbit.visible=t,null!=this.downbit&&(this.downbit.visible=!1))}),n.init=function(t,e,i,s){void 0===e&&(e=""),void 0===i&&(i=""),void 0===s&&(s=null);var n;n=RES.getRes(t),this.upbit=new egret.Bitmap(n),""!=e&&(n=RES.getRes(e),this.downbit=new egret.Bitmap(n),this.addChild(this.downbit),this.downbit.visible=!1),""!=i&&(n=RES.getRes(i),this.disenablebit=new egret.Bitmap(n),this.addChild(this.disenablebit),this.disenablebit.visible=!1),this.addChild(this.upbit),s?(this.hitAreaObj=new egret.Shape,this.hitAreaObj.graphics.beginFill(0,0),this.hitAreaObj.graphics.drawRect(s.x,s.y,s.width,s.height),this.hitAreaObj.graphics.endFill(),this.hitAreaObj.touchEnabled=!0,this.touchEnabled=!1,this.addChild(this.hitAreaObj),this.hitAreaObj.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.hitAreaObj.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.hitAreaObj.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this)):(this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this))},n.onTouchBegin=function(t){this._enable&&(this.isClip?null!=this.downbit&&(this.downbit.visible=!this.downbit.visible,this.upbit.visible=!this.downbit.visible,this.currentState=this.downbit.visible?2:1,null!=this.changeState&&this.changeState(this.currentState)):null!=this.downbit&&(this.downbit.visible=!0,this.upbit.visible=!1))},n.onTouchEnd=function(t){this._enable&&(this.isClip||null!=this.downbit&&(this.upbit.visible=!0,this.downbit.visible=!1))},n.destroy=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEnd,this),this.upbit=null,this.downbit=null,this.disenablebit=null},e}(egret.DisplayObjectContainer);egret.registerClass(SimpleButton,"SimpleButton");var StartScene=function(t){function e(){t.call(this),this.clouds=new Array,this.addEventListener(eui.UIEvent.COMPLETE,this.onComplete,this),this.skinName="resource/StartSceneSkin.exml"}__extends(e,t);var i=(__define,e),s=i.prototype;return s.createUI=function(){var t=new egret.Bitmap(RES.getRes("images.cloud"));t.x=-t.width,t.y=(this.height-t.width)/2+60,this.cloudsContainer.addChild(t),this.clouds.push([t,1.3]);var e=new egret.Bitmap(RES.getRes("images.cloud2"));e.x=-e.width,e.y=(this.height-e.width)/2+98,this.cloudsContainer.addChild(e),this.clouds.push([e,.8]);var i=new egret.Bitmap(RES.getRes("images.cloud3"));i.x=-i.width,i.y=(this.height-i.width)/2+38,this.cloudsContainer.addChild(i),this.clouds.push([i,.6]),this.cloudsInterval=egret.setInterval(this.cloudsMoving,this,50);var s=new SimpleButton("images.startbtnup","images.startbtnover");s.x=548,s.y=378,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){GlobalModel.main.changeToSceneByName("PlayScene")},this),this.addChild(s),this.introSprite=new GameIntroSprite;var n=new SimpleButton("images.gameintrobtnup","images.gameintrobtnover");n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){this.addChild(this.introSprite)},this),n.x=218,n.y=378,this.addChild(n),GlobalModel.audioManager.play("bg",!0,null,this,!0)},s.cloudsMoving=function(){for(var t,e,i=0;i<this.clouds.length;i++)t=this.clouds[i][0],e=this.clouds[i][1],t.x+e>=this.width?t.x=-t.width:t.x=t.x+e},s.onComplete=function(){this.bgImage&&(this.bgImage.source=RES.getRes("images.startscenetitle")),this.cloudsContainer&&this.createUI(),this.version&&(this.version.text="v"+GlobalModel.version)},e}(eui.Component);egret.registerClass(StartScene,"StartScene");var TimeManager=function(t){function e(){t.call(this),this.runTime=0,this.isForwarding=!0,this.timeMode="s",this.totalTime=0,this.challengeStartTime=0,this.twinkleTime=30,this.twinkleStartTime=0,this.lastRunTime=0}__extends(e,t);var i=(__define,e),s=i.prototype;return s.refreshTwinkleStartTime=function(){this.twinkleStartTime=(new Date).getTime()},s.startTime=function(){var t=new Date;this.runTime=t.getTime(),this.lastRunTime=this.runTime,this.hasEventListener(egret.Event.ENTER_FRAME)||this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrameHander,this)},s.onEnterFrameHander=function(){var t=(new Date).getTime(),e=(t-this.runTime)/1e3,i=t,s=i-this.lastRunTime;this.lastRunTime=i;var n;n=this.isForwarding?this.challengeStartTime+e:this.totalTime-e,0>n&&(n=0);var o=this.getTimeString(n);if(this.timeFunction&&this.timeFunction.call(this.thisObj,o,s),0>=n&&(this.isForwarding||this.timeEndFunction&&this.timeEndFunction.call(this.thisObj)),this.isTwinkling){var h=(t-this.twinkleStartTime)/1e3;h>=this.twinkleTime&&console.log("间歇计时到点")}},s.getTimeString=function(t){var e=Math.ceil(t/60)+"",i=Math.ceil(t%60)+"",s="";return"ms"==this.timeMode&&(s=e.length<2?"0"+e:e,s+=":"),i.length<2?s=s+"0"+i:s+=i,s},s.stopTime=function(){this.hasEventListener(egret.Event.ENTER_FRAME)&&(this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrameHander,this),this.totalTime=this.totalTime-((new Date).getTime()-this.runTime)/1e3,this.challengeStartTime=this.challengeStartTime+((new Date).getTime()-this.runTime)/1e3)},s.resumeTime=function(){this.refreshTwinkleStartTime(),this.hasEventListener(egret.Event.ENTER_FRAME)||this.startTime()},s.refresh=function(t,i,s,n,o,h){this.thisObj=h,null==i&&(i=!0),this.isForwarding=i,null==t&&(t=0),this.timeFunction=n,this.timeEndFunction=o,this.isForwarding?this.challengeStartTime=t:this.totalTime=t,s||(s=e.SECOND),this.timeMode=s,this.stopTime(),this.timeFunction&&this.timeFunction.call(this.thisObj,this.getTimeString(t),0),this.refreshTwinkleStartTime(),this.startTime()},e.MINUTE_AND_SECOND="ms",e.SECOND="s",e}(egret.Sprite);egret.registerClass(TimeManager,"TimeManager");var TimeSprite=function(t){function e(){t.call(this),this.timeManager=new TimeManager;var e=new egret.Bitmap(RES.getRes("images.timepanelbg"));this.addChild(e),this.text=new egret.TextField,this.text.multiline=!1,this.text.wordWrap=!1,this.text.fontFamily=GlobalModel.font,this.text.bold=!0,this.text.size=19,this.text.textColor=0,this.text.text=String(GlobalModel.startTime),this.text.x=(this.width-this.text.width)/2+10,this.text.y=egret.Capabilities.isMobile?7:13,this.addChild(this.text),this.addChild(this.timeManager)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.refreshTime=function(t,e){this.text.text=t,GlobalModel.playTime+=e},s.timeEnd=function(){GlobalModel.isTimeEnd=!0,this.timeManager.stopTime(),this.timeEndFunction&&this.timeEndFunction.call(this.thisObj)},s.stopTime=function(){this.timeManager.stopTime()},s.resume=function(){this.timeManager.resumeTime()},s.start=function(t,e){this.timeEndFunction=t,this.thisObj=e,this.timeManager.refresh(GlobalModel.startTime,!1,TimeManager.SECOND,this.refreshTime,this.timeEnd,this)},e}(egret.DisplayObjectContainer);egret.registerClass(TimeSprite,"TimeSprite");